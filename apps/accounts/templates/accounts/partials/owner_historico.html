<div id="owner-historico">
  <form class="row g-2 mb-3"
        hx-get="{% url 'accounts:owner_historico' %}"
        hx-target="#owner-historico"
        hx-select="#owner-historico"
        hx-swap="outerHTML">
    <div class="col">
      <input type="date" name="inicio" class="form-control" value="{{ request.GET.inicio }}">
    </div>
    <div class="col">
      <input type="date" name="fim" class="form-control" value="{{ request.GET.fim }}">
    </div>
    <div class="col">
      <input type="text" name="cliente" class="form-control" placeholder="Cliente" value="{{ request.GET.cliente }}">
    </div>
    <div class="col-auto">
      <button type="submit" class="btn btn-primary">Filtrar</button>
    </div>
  </form>
  <table class="table table-striped">
    <thead>
      <tr>
        <th>Data de agendamento</th>
        <th>Data de atendimento</th>
        <th>Cliente</th>
        <th>Profissional</th>
        <th>Serviços</th>
        <th>Valor</th>
        <th>Desconto?</th>
        <th>No-show?</th>
      </tr>
    </thead>
    <tbody>
      {% for ag in page_obj %}
      <tr>
        <td>{{ ag.criado_em|date:"d/m/Y H:i" }}</td>
        <td>{{ ag.data|date:"d/m/Y" }} {{ ag.hora|time:"H:i" }}</td>
        <td>{{ ag.cliente.full_name }}</td>
        <td>{{ ag.funcionario.nome }}</td>
        <td>
          {% for s in ag.servicos.all %}{% if not forloop.first %}, {% endif %}{{ s.nome }}{% endfor %}
        </td>
        <td>{% if ag.valor_final %}R$ {{ ag.valor_final }}{% else %}-{% endif %}</td>
        <td>{% if ag.teve_desconto %}Sim{% else %}Não{% endif %}</td>
        <td>{% if ag.no_show %}Sim{% else %}Não{% endif %}</td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="8">Nenhum atendimento encontrado.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <nav aria-label="Paginação">
    <ul class="pagination">
      {% if page_obj.has_previous %}
        <li class="page-item">
          <a class="page-link"
             hx-get="{% url 'accounts:owner_historico' %}?page={{ page_obj.previous_page_number }}{% if querystring %}&{{ querystring }}{% endif %}"
             hx-target="#owner-historico"
             hx-select="#owner-historico"
             hx-swap="outerHTML">&laquo;</a>
        </li>
      {% else %}
        <li class="page-item disabled"><span class="page-link">&laquo;</span></li>
      {% endif %}

      {% for i in page_obj.paginator.page_range %}
        <li class="page-item {% if page_obj.number == i %}active{% endif %}">
          <a class="page-link"
             hx-get="{% url 'accounts:owner_historico' %}?page={{ i }}{% if querystring %}&{{ querystring }}{% endif %}"
             hx-target="#owner-historico"
             hx-select="#owner-historico"
             hx-swap="outerHTML">{{ i }}</a>
        </li>
      {% endfor %}

      {% if page_obj.has_next %}
        <li class="page-item">
          <a class="page-link"
             hx-get="{% url 'accounts:owner_historico' %}?page={{ page_obj.next_page_number }}{% if querystring %}&{{ querystring }}{% endif %}"
             hx-target="#owner-historico"
             hx-select="#owner-historico"
             hx-swap="outerHTML">&raquo;</a>
        </li>
      {% else %}
        <li class="page-item disabled"><span class="page-link">&raquo;</span></li>
      {% endif %}
    </ul>
  </nav>
</div>
